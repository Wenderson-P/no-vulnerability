import React, { useEffect, useState } from 'react';
import Head from 'next/head';
import Header from '../../components/Header';
import api from '../../services/api';
import { useAuth } from '../../context/AuthContext';

function adminDashboard() {
  const [users, setUsers] = useState();
  const { user, handleLogout } = useAuth();

  useEffect(() => {
    async function loadData() {
      const response = await api.get('api/v1/admin', { headers: { 'x-access-token': user.token } });
      setUsers(response.data);
    }
    if (user) {
      loadData();
    }
  }, []);

  return (
    <>
      <Head>
        <title> Admin - Sistema anti-vulnerabilidade</title>
      </Head>
      <div className="flex flex-col items-center justify-center min-h-screen py-12 px-4 sm:px-6 lg:px-8">
        <Header title="Admin Dashboard" />
        <h3 className="text-xl">Lista de usu√°rios</h3>
        <div className="space-y-8 my-8 w-4/5 ">
          {users && users.map((systemUser) => (
            <div className="shadow-lg flex flex-row bg-gray-200 rounded justify-between align-center ">
              <div className="py-4 ml-8">{systemUser.id}</div>
              <div className="py-4 text-center">{systemUser.username}</div>
              <div className="py-4 mr-8">{systemUser.email}</div>
            </div>
          ))}
        </div>
      </div>
    </>
  );
}

export default adminDashboard;
